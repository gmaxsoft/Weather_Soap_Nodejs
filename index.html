<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <title>Demo Klienta SOAP - Pogoda</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h2>ğŸŒ©ï¸ Prognoza Pogody (SOAP Demo Express)</h2>
    <p>Wpisz kod pocztowy USA, aby pobraÄ‡ prognozÄ™ (np. **02110**):</p>
    <form id="weather-form">
        <label for="zip-code">Kod Pocztowy (ZIP):</label>
        <input type="text" id="zip-code" name="zip" required maxlength="5" pattern="\d{5}" value="02110">
        <button type="submit">Pobierz PogodÄ™</button>
    </form>
    <div id="result">
        Oczekiwanie na dane...
    </div>
    <script>
        document.getElementById('weather-form').addEventListener('submit', async function (event) {
            event.preventDefault();
            const zip = document.getElementById('zip-code').value;
            const resultDiv = document.getElementById('result');
            resultDiv.textContent = `Åadowanie danych SOAP dla kodu ${zip}...`;

            try {
                // WywoÅ‚anie endpointu REST na serwerze Express, ktÃ³ry to robi za nas Å¼Ä…danie SOAP
                const response = await fetch('/api/weather?zip=' + zip);
                const data = await response.json();

                if (!response.ok) {
                    // ObsÅ‚uga bÅ‚Ä™dÃ³w zwrÃ³conych przez nasz serwer Express
                    throw new Error(data.error || 'Nieznany bÅ‚Ä…d serwera.');
                }

                // Formatowanie i wyÅ›wietlanie wyniku
                resultDiv.textContent = `
Miasto: ${data.City}
Stan: ${data.State}
---
Warunki: ${data.Description}
Temperatura: ${data.Temperature}Â°F
                `;

            } catch (error) {
                resultDiv.textContent = 'âŒ WystÄ…piÅ‚ bÅ‚Ä…d: ' + error.message;
            }
        });
    </script>
</body>

</html>